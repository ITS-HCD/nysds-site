<nav class="section-navigator">
  <ul>
    
    {% if section in collections.sections %}
      {# First loop: Show only top-level pages (no parent) #}

      {% for page in collections.sections[section] if page.data.parent == None or page.data.parent == "" %}
        <li class="{% if page.url == page.url %} active{% endif %}">
          <a href="{{ page.url }}">{{ page.data.title }}</a>
        </li>

        {# Second loop: Show children (if any exist) #}
        {% if page.children.length > 0 %}
          <ul>
            {% for child in page.children %}
              <li class="{% if child.url == page.url %} active{% endif %}">
                <a href="{{ child.url }}">{{ child.data.title }}</a>
              </li>
            {% endfor %}
          </ul>
        {% endif %}

      {% endfor %}
    {% endif %}
  </ul>
</nav>
